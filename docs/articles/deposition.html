<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="svatools">
<title>Atmospheric deposition • svatools</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Atmospheric deposition">
<meta property="og:description" content="svatools">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">svatools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/calibration.html">Calibration data</a>
    <a class="dropdown-item" href="../articles/deposition.html">Atmospheric deposition</a>
    <a class="dropdown-item" href="../articles/land_use.html">Land use</a>
    <a class="dropdown-item" href="../articles/soil.html">Soil parameters</a>
    <a class="dropdown-item" href="../articles/weather.html">Weather data</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/biopsichas/svatools/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Atmospheric deposition</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/biopsichas/svatools/blob/HEAD/vignettes/deposition.Rmd" class="external-link"><code>vignettes/deposition.Rmd</code></a></small>
      <div class="d-none name"><code>deposition.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>According to <span class="citation">Grizzetti et al. (2005)</span>
study done in three catchments in Europe atmospheric deposition
constituted between 3 and 16% of total nitrogen inputs. <span class="citation">Helsinki Commission (2018)</span> report indicates the
around 30% of nitrogen load to the Baltic Sea comes from atmospheric
deposition, while it contributes from 1 to 10% of nitrogen load to
inland surface waters in sea surrounding countries. Therefore setting
atmospheric deposition to appropriate level should help better constrain
other parameters responsible for nitrogen transport processes in the
catchment.</p>
<p><a href="https://swat.tamu.edu/software/plus/" class="external-link">SWAT+</a> considers
nitrogen deposition (NH4 and NO3), but not phosphorous deposition. Both
wet and dry deposition is taken into account. Wet deposition is
absorption of compounds by rain and snow as they fall and is expressed
in <span class="math inline">\(mg/l\)</span>, whereas dry deposition is
direct adsorption of compounds to water and land surfaces, expressed in
<span class="math inline">\(kg/ha/year\)</span>. SWAT+ allows constant,
annual or monthly input data on atmospheric deposition. The choice is
controlled by <em>atmo</em> parameter in the <em>‘codes.bsn’</em>
file.</p>
</div>
<div class="section level2">
<h2 id="emep-data">EMEP data<a class="anchor" aria-label="anchor" href="#emep-data"></a>
</h2>
<p>Nitrogen atmospheric could be obtained from local sources. However,
if local data in not available or not all parameters available,
deposition data can be extracted from European Monitoring and Evaluation
Programme (EMEP) provided <a href="https://www.emep.int/mscw/mscw_moddata.html" class="external-link">MSC-W model data
files</a>. The EMEP portal provides gridded 0.1<span class="math inline">\(^{\circ}\)</span> resolution <em>netCDF</em> data
over Europe. MSC-W model <a href="https://www.emep.int/grid/lonlatgrid.pdf" class="external-link">grid covers
territory</a> between -30 to 90 longitude and 30 to 82 latitude with
50x50 km<sup>2</sup> grid cell. The parameters, which are needed for
SWAT+ model are:</p>
<ul>
<li>
<em>DDEP_OXN_m2GridDry</em> - deposition of oxidized nitrogen per m2
grid (<span class="math inline">\(mgN/m^2\)</span>);</li>
<li>
<em>WDEP_OXN</em> - wet deposition of oxidized nitrogen (<span class="math inline">\(mgN/m^2\)</span>);</li>
<li>
<em>DDEP_RDN_m2Grid</em> - dry deposition of reduced nitrogen per m2
grid (<span class="math inline">\(mgN/m^2\)</span>);</li>
<li>
<em>WDEP_RDN</em> - wet deposition of reduced nitrogen (<span class="math inline">\(mgN/m^2\)</span>).</li>
<li>
<em>WDEP_PREC</em> - precipitation (<span class="math inline">\(mm\)</span>).</li>
</ul>
<p>These parameters can be used to prepare following SWAT+ parameters
required for <em>‘atmo.cli’</em> input file:</p>
<ul>
<li>
<em>NH4_RF</em> - ammonia in rainfall (<span class="math inline">\(mg/l\)</span>);</li>
<li>
<em>NO3_RF</em> - nitrate in rainfall (<span class="math inline">\(mg/l\)</span>);</li>
<li>
<em>NH4_DRY</em> - ammonia dry deposition (<span class="math inline">\(kg/ha/yr\)</span>);</li>
<li>
<em>NO3_DRY</em> - nitrate dry deposition (<span class="math inline">\(kg/ha/yr\)</span>).</li>
</ul>
<p>EMEP provides access to yearly, monthly, daily and hourly data. Data
for a selected catchment with required time step could be extracted
directly from <a href="https://www.emep.int/mscw/mscw_moddata.html" class="external-link">EMEP
website</a> with <a href="../reference/get_atmo_dep.html">get_atmo_dep</a> function.
Function requires just path to catchment boundary shape file and
internet connection. Depending of the data time step selected (yearly to
hourly), function will need more or less time to run (less with “year”
selected, much much more with “hour”). More information about the
inclusion of atmospheric deposition data in SWAT+ modeling is presented
in the section 3.10 of <a href="https://doi.org/10.5281/zenodo.7463395" class="external-link">SWAT+ modelling
protocol</a>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/biopsichas/svatools" class="external-link">svatools</a></span><span class="op">)</span></span>
<span><span class="va">basin_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"GIS/basin.shp"</span>, package <span class="op">=</span> <span class="st">"svatools"</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_atmo_dep.html">get_atmo_dep</a></span><span class="op">(</span><span class="va">basin_path</span><span class="op">)</span></span>
<span><span class="co">##Plot results</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="fu">pivot_longer</span><span class="op">(</span><span class="va">df</span>, <span class="op">!</span><span class="va">DATE</span>, names_to <span class="op">=</span> <span class="st">"par"</span>, values_to <span class="op">=</span> <span class="st">"values"</span><span class="op">)</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">DATE</span>, y <span class="op">=</span> <span class="va">values</span><span class="op">)</span><span class="op">)</span><span class="op">+</span> </span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span><span class="op">+</span> </span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">par</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span><span class="op">+</span> </span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Rplot.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="swat-input">SWAT+ input<a class="anchor" aria-label="anchor" href="#swat-input"></a>
</h2>
<p>Atmospheric deposition data into SWAT+ model can be included via
<em>‘atmodep.cli’</em> file. For this <a href="../reference/add_atmo_dep.html">add_atmo_dep</a> function was
designed. It could write yearly, monthly or whole modeled period
averages. Function requires only <a href="../reference/get_atmo_dep.html">get_atmo_dep</a> function output
for yearly or monthly data. SWAT+ model setup <code>.sqlite</code>
database has to be updated too. Thus, this function updates also
required tables. In case other than average yearly atmospheric
deposition data are used, <em>t_ext</em> function parameter should be
provided. Please read more in <a href="../reference/add_atmo_dep.html">add_atmo_dep</a>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db_path</span> <span class="op">&lt;-</span> <span class="st">"./output/test/project.sqlite"</span></span>
<span><span class="fu"><a href="../reference/add_atmo_dep.html">add_atmo_dep</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">db_path</span><span class="op">)</span></span></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-grizzetti2005" class="csl-entry">
Grizzetti, B., F. Bouraoui, G. de Marsily, and G. Bidoglio. 2005.
<span>“A Statistical Method for Source Apportionment of Riverine
Nitrogen Loads.”</span> <em>Journal of Hydrology</em> 304 (1): 302–15.
https://doi.org/<a href="https://doi.org/10.1016/j.jhydrol.2004.07.036" class="external-link">https://doi.org/10.1016/j.jhydrol.2004.07.036</a>.
</div>
<div id="ref-helcom2018" class="csl-entry">
Helsinki Commission. 2018. <span>“<span class="nocase">Sources and
pathways of nutrients to the Baltic Sea. Baltic Sea Environment
Proceedings No. 153</span>.”</span>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Svajunas Plunge.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
